Solved various problems with limits on either memory or efficiency
